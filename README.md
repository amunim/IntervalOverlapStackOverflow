IntervalOverlapStackOverflow

Stack overflow question was asked for a way to insert items into batches with around a million records, since the question was deleted I decided to post my answer here ;)
